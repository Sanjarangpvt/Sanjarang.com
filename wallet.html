<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wallet - Loan Book</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="sidebar.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img id="sidebar-logo" src="" alt="" style="display: none;">
                <span id="sidebar-company-name">LOAN MANAGER</span>
            </div>
            <nav>
                <a href="dashboard.html"><i class="bi bi-speedometer2"></i> <span class="link-text">Dashboard</span></a>
                <a href="manage-loans.html"><i class="bi bi-cash-coin"></i> <span class="link-text">Manage Loans</span></a>
                <a href="wallet.html" class="active"><i class="bi bi-wallet2"></i> <span class="link-text">Wallet</span></a>
                <a href="expenses.html"><i class="bi bi-receipt"></i> <span class="link-text">Expenses</span></a>
                <a href="forms.html"><i class="bi bi-file-earmark-text"></i> <span class="link-text">Forms</span></a>
                <a href="profile.html"><i class="bi bi-building"></i> <span class="link-text">Company Profile</span></a>
                <a href="settings.html"><i class="bi bi-gear"></i> <span class="link-text">Settings</span></a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <header class="custom-header-box">
                <div class="header-container">
                    <div class="header-left">
                        <button id="sidebar-toggle" class="icon-btn">☰</button>
                        <div class="header-title-group">
                            <h1>My Wallet</h1>
                            <div class="user-profile">
                                <span class="user-name">Admin</span>
                                <span class="user-role">Administrator</span>
                            </div>
                        </div>
                    </div>
                    <div class="header-right">
                        <div class="search-wrapper">
                            <input type="text" id="global-search" placeholder="Search borrowers...">
                            <div id="search-results" class="search-dropdown"></div>
                        </div>
                        <div id="current-datetime"></div>
                    </div>
                </div>
            </header>
            <main>
                <section class="card">
                    <h2>Wallet Balance</h2>
                    <div style="display: flex; align-items: center; gap: 20px; margin-top: 20px;">
                        <div id="wallet-balance" style="font-size: 3rem; font-weight: bold; color: #27ae60;">₹0.00</div>
                        <button id="add-funds-btn" style="padding: 10px 20px; background-color: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">Add / Withdraw</button>
                    </div>
                    <p style="color: #7f8c8d; margin-top: 10px;">Track your capital and expenses here.</p>
                </section>

                <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 20px;">
                    <section class="card" style="flex: 1; min-width: 200px; border-left: 5px solid #27ae60;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin: 0; color: #7f8c8d; font-size: 1rem; text-transform: uppercase;">Total Income</h3>
                                <div id="total-income-display" style="font-size: 1.8rem; font-weight: bold; color: #2c3e50; margin-top: 5px;">₹0.00</div>
                            </div>
                            <div style="font-size: 2rem; color: #27ae60; opacity: 0.2;">⬇️</div>
                        </div>
                    </section>
                    <section class="card" style="flex: 1; min-width: 200px; border-left: 5px solid #e74c3c;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <h3 style="margin: 0; color: #7f8c8d; font-size: 1rem; text-transform: uppercase;">Total Expenses</h3>
                                <div id="total-expense-display" style="font-size: 1.8rem; font-weight: bold; color: #2c3e50; margin-top: 5px;">₹0.00</div>
                            </div>
                            <div style="font-size: 2rem; color: #e74c3c; opacity: 0.2;">⬆️</div>
                        </div>
                    </section>
                </div>

                <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                    <section class="card" style="flex: 1; min-width: 300px;">
                        <h2>Financial Overview</h2>
                        <div style="height: 300px;">
                            <canvas id="walletChart"></canvas>
                        </div>
                    </section>

                    <section class="card" style="flex: 1; min-width: 300px;">
                        <h2>Expense Distribution</h2>
                        <div style="height: 300px;">
                            <canvas id="expenseChart"></canvas>
                        </div>
                    </section>
                </div>

                <section class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
                        <h2 style="margin: 0; border: none;">Transaction History</h2>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <label for="start-date" style="font-weight:bold; font-size:0.9rem;">From:</label>
                            <input type="date" id="start-date" style="padding: 5px; border-radius: 4px; border: 1px solid #ddd;">
                            <label for="end-date" style="font-weight:bold; font-size:0.9rem;">To:</label>
                            <input type="date" id="end-date" style="padding: 5px; border-radius: 4px; border: 1px solid #ddd;">
                            <button id="filter-btn" style="padding: 8px 15px; background-color: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">Filter</button>
                            <button id="clear-filter-btn" style="padding: 8px 15px; background-color: #95a5a6; color: white; border: none; border-radius: 5px; cursor: pointer;">Clear</button>
                            <button id="export-csv-btn" style="padding: 8px 15px; background-color: #27ae60; color: white; border: none; border-radius: 5px; cursor: pointer;">Export CSV</button>
                        </div>
                    </div>
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr>
                                <th style="text-align: left; padding: 10px; border-bottom: 1px solid #eee;">Date</th>
                                <th style="text-align: left; padding: 10px; border-bottom: 1px solid #eee;">Borrower</th>
                                <th style="text-align: left; padding: 10px; border-bottom: 1px solid #eee;">Description</th>
                                <th style="text-align: left; padding: 10px; border-bottom: 1px solid #eee;">Type</th>
                                <th style="text-align: right; padding: 10px; border-bottom: 1px solid #eee;">Amount</th>
                                <th style="text-align: center; padding: 10px; border-bottom: 1px solid #eee;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="transaction-table-body"></tbody>
                    </table>
                    <div style="display: flex; justify-content: flex-end; gap: 10px; margin-top: 15px; align-items: center;">
                        <button id="prev-page-btn" style="padding: 5px 15px; background-color: #95a5a6; color: white; border: none; border-radius: 4px; cursor: pointer;" disabled>Previous</button>
                        <span id="page-indicator" style="font-size: 0.9rem; color: #7f8c8d;">Page 1</span>
                        <button id="next-page-btn" style="padding: 5px 15px; background-color: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">Next</button>
                    </div>
                </section>
            </main>
        </div>
    </div>

    <!-- Add Funds Modal -->
    <div id="transaction-modal" class="custom-modal">
        <div class="custom-modal-content" style="max-width: 400px;">
            <span class="custom-close-modal" id="close-trans-modal">&times;</span>
            <h2>New Transaction</h2>
            <form id="transaction-form">
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">Type</label>
                    <select id="trans-type" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                        <option value="Deposit">Deposit (+)</option>
                        <option value="Withdrawal">Withdrawal (-)</option>
                    </select>
                </div>
                <div class="form-group" style="margin-bottom: 15px;"><label style="display:block; margin-bottom:5px; font-weight:bold;">Amount</label><input type="number" id="trans-amount" required step="0.01" style="width: 100%;"></div>
                <div class="form-group" style="margin-bottom: 15px;"><label style="display:block; margin-bottom:5px; font-weight:bold;">Description</label><input type="text" id="trans-desc" placeholder="e.g. Capital Injection" required style="width: 100%;"></div>
                <button type="submit" style="width: 100%; margin-top: 10px;">Save Transaction</button>
            </form>
        </div>
    </div>
    <script src="app.js" defer></script>
    <script src="wallet.js" defer></script>
</body>
</html>