<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No Objection Certificate (NOC)</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="sidebar.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        .agreement-container { position: relative; overflow: hidden; background-color: white; width: 210mm; min-height: 297mm; margin: 0 auto; padding: 35mm 20mm 20mm 20mm; border: 1px solid #ccc; box-sizing: border-box; font-family: 'Times New Roman', Times, serif; }
        .agreement-container h1 { text-align: center; color: #000; text-transform: uppercase; text-decoration: underline; margin-bottom: 30px; font-size: 24px; border: none; padding: 0; }
        .agreement-content { margin: 20px 0; line-height: 1.8; color: #000; text-align: justify; font-size: 12pt; }
        .agreement-signature-section { display: flex; justify-content: space-between; margin-top: 80px; }
        .agreement-signature-box { border-top: 1px solid #000; width: 40%; padding-top: 5px; text-align: center; font-size: 12pt; }
        .agreement-watermark {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 100px; color: rgba(150, 150, 150, 0.15); z-index: 0; pointer-events: none;
            font-weight: bold; white-space: nowrap; border: 10px solid rgba(150, 150, 150, 0.15); padding: 20px; border-radius: 20px;
        }
    </style>
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar -->
        ipt>
        document.addEventListener('DOMContentLoaded', () => {
            const savedProfile = JSON.parse(localStorage.getItem('companyProfile')) || {};
            if (savedProfile.name) {
                document.getElementById('noc-company-name').textContent = savedProfile.name.toUpperCase();
                document.getElementById('noc-company-sign-name').textContent = savedProfile.name;
            }
            
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            const dateStr = `${day}/${month}/${year}`;
            
            document.getElementById('noc-date').textContent = dateStr;
        });

        function downloadNOC() {
            const element = document.getElementById('noc-paper');
            const opt = { margin: 0, filename: 'No_Objection_Certificate.pdf', image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2, useCORS: true }, jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' } };
            html2pdf().set(opt).from(element).save();
        }
    </script>
</body>
</html>