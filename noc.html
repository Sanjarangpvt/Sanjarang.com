<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>No Objection Certificate (NOC)</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="sidebar.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        .agreement-container { position: relative; overflow: hidden; background-color: white; width: 210mm; min-height: 297mm; margin: 0 auto; padding: 35mm 20mm 20mm 20mm; border: 1px solid #ccc; box-sizing: border-box; font-family: 'Times New Roman', Times, serif; }
        .agreement-container h1 { text-align: center; color: #000; text-transform: uppercase; text-decoration: underline; margin-bottom: 30px; font-size: 24px; border: none; padding: 0; }
        .agreement-content { margin: 20px 0; line-height: 1.8; color: #000; text-align: justify; font-size: 12pt; }
        .agreement-signature-section { display: flex; justify-content: space-between; margin-top: 80px; }
        .agreement-signature-box { border-top: 1px solid #000; width: 40%; padding-top: 5px; text-align: center; font-size: 12pt; }
        .agreement-watermark {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 100px; color: rgba(150, 150, 150, 0.15); z-index: 0; pointer-events: none;
            font-weight: bold; white-space: nowrap; border: 10px solid rgba(150, 150, 150, 0.15); padding: 20px; border-radius: 20px;
        }
    </style>
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img id="sidebar-logo" src="" alt="" style="display: none;">
                <span id="sidebar-company-name">LOAN MANAGER</span>
            </div>
            <nav>
                <a href="dashboard.html"><i class="bi bi-speedometer2"></i> <span class="link-text">Dashboard</span></a>
                <a href="manage-loans.html"><i class="bi bi-cash-coin"></i> <span class="link-text">Manage Loans</span></a>
                <a href="wallet.html"><i class="bi bi-wallet2"></i> <span class="link-text">Wallet</span></a>
                <a href="expenses.html"><i class="bi bi-receipt"></i> <span class="link-text">Expenses</span></a>
                <a href="forms.html"><i class="bi bi-file-earmark-text"></i> <span class="link-text">Forms</span></a>
                <a href="profile.html"><i class="bi bi-building"></i> <span class="link-text">Company Profile</span></a>
                <a href="settings.html"><i class="bi bi-gear"></i> <span class="link-text">Settings</span></a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <header class="custom-header-box">
                <div class="header-container">
                    <div class="header-left">
                        <button id="sidebar-toggle" class="icon-btn">â˜°</button>
                        <div class="header-title-group">
                            <h1>No Objection Certificate</h1>
                            <div class="user-profile">
                                <span class="user-name">Admin</span>
                                <span class="user-role">Administrator</span>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <main>
                <div class="btn-container" style="text-align: right; margin-bottom: 20px;">
                    <button onclick="downloadNOC()" class="btn" style="background-color: #27ae60; color: white;">Download PDF</button>
                    <button onclick="window.print()" class="btn btn-print" style="background-color: #3498db; color: white;">Print</button>
                </div>

                <div id="noc-paper" class="agreement-container">
                    <div class="agreement-watermark">NOC</div>
                    <h1>TO WHOM IT MAY CONCERN</h1>
                    <p style="text-align: right;"><strong>Date:</strong> <span id="noc-date">__________________</span></p>

                    <div class="agreement-content">
                        <p>This is to certify that <strong><span id="noc-borrower-name">______________________________________________________</span></strong>,
                        resident of <strong>________________________________________________________________________</strong>,
                        had availed a loan (Loan Ref: <strong>__________________</strong>) from <strong><span id="noc-company-name">SANJARANG PRIVATE LIMITED</span></strong>.</p>

                        <p>We hereby confirm that the said borrower has repaid the entire loan amount along with the accrued interest and other charges. There are no outstanding dues against the said loan account as of date.</p>

                        <p>This institution has <strong>NO OBJECTION</strong> to the borrower closing this account or availing financial facilities from other institutions.</p>
                    </div>

                    <div class="agreement-signature-section">
                        <div style="width: 40%;"></div> <!-- Spacer -->
                        <div class="agreement-signature-box">
                            <p><strong>For <span id="noc-company-sign-name">Sanjarang Pvt Ltd</span></strong><br>(Authorized Signatory)</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <script src="app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const savedProfile = JSON.parse(localStorage.getItem('companyProfile')) || {};
            if (savedProfile.name) {
                document.getElementById('noc-company-name').textContent = savedProfile.name.toUpperCase();
                document.getElementById('noc-company-sign-name').textContent = savedProfile.name;
            }
            
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            const dateStr = `${day}/${month}/${year}`;
            
            document.getElementById('noc-date').textContent = dateStr;
        });

        function downloadNOC() {
            const element = document.getElementById('noc-paper');
            const opt = { margin: 0, filename: 'No_Objection_Certificate.pdf', image: { type: 'jpeg', quality: 0.98 }, html2canvas: { scale: 2, useCORS: true }, jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' } };
            html2pdf().set(opt).from(element).save();
        }
    </script>
</body>
</html>