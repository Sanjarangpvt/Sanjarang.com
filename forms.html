<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Forms Repository - Loan Book</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="sidebar.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        /* Styles for the hidden agreement PDF generation */
        .agreement-container { position: relative; overflow: hidden; background-color: white; width: 210mm; min-height: 297mm; margin: 0 auto; padding: 35mm 20mm 20mm 20mm; border: 1px solid #ccc; box-sizing: border-box; font-family: 'Times New Roman', Times, serif; }
        .agreement-container h1 { text-align: center; color: #000; text-transform: uppercase; text-decoration: underline; margin-bottom: 30px; font-size: 24px; border: none; padding: 0; }
        .agreement-container h3 { font-size: 14px; margin-top: 20px; margin-bottom: 5px; text-transform: uppercase; color: #000; }
        .agreement-content { margin: 20px 0; line-height: 1.8; color: #000; text-align: justify; font-size: 12pt; }
        .agreement-signature-section { display: flex; justify-content: space-between; margin-top: 80px; }
        .agreement-signature-box { border-top: 1px solid #000; width: 22%; padding-top: 5px; text-align: center; font-size: 12pt; }
        .agreement-watermark {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 100px; color: rgba(150, 150, 150, 0.15); z-index: 0; pointer-events: none;
            font-weight: bold; white-space: nowrap; border: 10px solid rgba(150, 150, 150, 0.15); padding: 20px; border-radius: 20px;
        }
        .sidebar::-webkit-scrollbar { display: none; }
        .sidebar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div class="app-layout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <img id="sidebar-logo" src="" alt="" style="display: none;">
                <span id="sidebar-company-name">LOAN MANAGER</span>
            </div>
            <nav>
                <a href="dashboard.html"><i class="bi bi-speedometer2"></i> <span class="link-text">Dashboard</span></a>
                <a href="manage-loans.html"><i class="bi bi-cash-coin"></i> <span class="link-text">Manage Loans</span></a>
                <a href="wallet.html"><i class="bi bi-wallet2"></i> <span class="link-text">Wallet</span></a>
                <a href="expenses.html"><i class="bi bi-receipt"></i> <span class="link-text">Expenses</span></a>
                <a href="forms.html" class="active"><i class="bi bi-file-earmark-text"></i> <span class="link-text">Forms</span></a>
                <a href="profile.html"><i class="bi bi-building"></i> <span class="link-text">Company Profile</span></a>
                <a href="settings.html"><i class="bi bi-gear"></i> <span class="link-text">Settings</span></a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <header class="custom-header-box">
                <div class="header-container">
                    <div class="header-left">
                        <button id="sidebar-toggle" class="icon-btn">☰</button>
                        <div class="header-title-group">
                            <h1>Forms Repository</h1>
                            <div class="user-profile">
                                <span class="user-name">Admin</span>
                                <span class="user-role">Administrator</span>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            <main>
                <section class="card">
                    <h2>Available Documents</h2>
                    <p>Access and manage standard forms and templates.</p>
                    <ul style="list-style: none; padding: 0; margin-top: 20px;">
                        <li style="background: #f8f9fa; padding: 20px; margin-bottom: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #eee; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div>
                                <div style="font-weight: bold; font-size: 1.1rem; color: #2c3e50;">Loan Application Form (Form A)</div>
                                <div style="font-size: 0.9rem; color: #7f8c8d; margin-top: 5px;">Standard application form for new borrower registration.</div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button id="download-blank-form-btn" style="background-color: #27ae60; color: white; padding: 10px 20px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: background 0.2s;">Download Blank PDF</button>
                                <a href="add-loan.html" target="_blank" style="background-color: #3498db; color: white; padding: 10px 20px; text-decoration: none; border-radius: 6px; font-weight: 600; transition: background 0.2s;">Open Form</a>
                            </div>
                        </li>
                        <li style="background: #f8f9fa; padding: 20px; margin-bottom: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #eee; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div>
                                <div style="font-weight: bold; font-size: 1.1rem; color: #2c3e50;">Loan Agreement Template</div>
                                <div style="font-size: 0.9rem; color: #7f8c8d; margin-top: 5px;">Standard legal agreement between lender and borrower.</div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button id="download-agreement-btn" style="background-color: #27ae60; color: white; padding: 10px 20px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: background 0.2s;">Download PDF</button>
                                <a href="agreement.html" target="_blank" style="background-color: #3498db; color: white; padding: 10px 20px; text-decoration: none; border-radius: 6px; font-weight: 600; transition: background 0.2s;">Open Agreement</a>
                            </div>
                        </li>
                        <li style="background: #f8f9fa; padding: 20px; margin-bottom: 15px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border: 1px solid #eee; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
                            <div>
                                <div style="font-weight: bold; font-size: 1.1rem; color: #2c3e50;">No Objection Certificate (NOC)</div>
                                <div style="font-size: 0.9rem; color: #7f8c8d; margin-top: 5px;">Standard certificate for loan clearance confirmation.</div>
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button id="download-noc-btn" style="background-color: #27ae60; color: white; padding: 10px 20px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer; transition: background 0.2s;">Download PDF</button>
                                <a href="noc.html" target="_blank" style="background-color: #3498db; color: white; padding: 10px 20px; text-decoration: none; border-radius: 6px; font-weight: 600; transition: background 0.2s;">Open Form</a>
                            </div>
                        </li>
                    </ul>
                </section>

                <section class="card">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h2>Custom Forms</h2>
                        <button id="upload-form-btn" style="background-color: #3498db; color: white; padding: 10px 20px; border: none; border-radius: 6px; font-weight: 600; cursor: pointer;">+ Upload New</button>
                    </div>
                    <p>Manage your own uploaded templates and documents.</p>
                    <ul id="custom-forms-list" style="list-style: none; padding: 0; margin-top: 20px;">
                        <!-- Populated by JS -->
                    </ul>
                </section>
            </main>
        </div>
    </div>

    <!-- Hidden Blank Form Template for PDF Generation -->
    <div style="position: absolute; left: -9999px;">
        <div id="blank-loan-form" class="paper-container">
            <div class="paper-header">
                <h1>SANJARANG PRIVATE LIMITED</h1>
                <h2>LOAN APPLICATION FORM</h2>
                <p>FORM - A</p>
            </div>

            <div class="form-section">
                <div class="section-title">Applicant Details</div>
                <div class="paper-row">
                    <div class="paper-col-2">
                        <div class="paper-row">
                            <div class="paper-col"><div class="field-group"><span class="field-label">Name of Applicant</span><input type="text" class="paper-input"></div></div>
                            <div class="paper-col"><div class="field-group"><span class="field-label">Date of Birth</span><input type="text" class="paper-input"></div></div>
                        </div>
                        <div class="paper-row">
                            <div class="paper-col"><div class="field-group"><span class="field-label">Father / Husband Name</span><input type="text" class="paper-input"></div></div>
                            <div class="paper-col"><div class="field-group"><span class="field-label">Guarantor Name</span><input type="text" class="paper-input"></div></div>
                        </div>
                    </div>
                    <div class="paper-col" style="flex: 0 0 130px;">
                        <div class="photo-box">Photo Area</div>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">Address & Contact</div>
                <div class="paper-row">
                    <div class="paper-col"><div class="field-group"><span class="field-label">Village</span><input type="text" class="paper-input"></div></div>
                    <div class="paper-col"><div class="field-group"><span class="field-label">P.O.</span><input type="text" class="paper-input"></div></div>
                </div>
                <div class="paper-row">
                    <div class="paper-col"><div class="field-group"><span class="field-label">District</span><input type="text" class="paper-input"></div></div>
                    <div class="paper-col"><div class="field-group"><span class="field-label">Pin No</span><input type="text" class="paper-input"></div></div>
                </div>
                <div class="paper-row">
                    <div class="paper-col"><div class="field-group"><span class="field-label">Mobile</span><input type="text" class="paper-input"></div></div>
                    <div class="paper-col"><div class="field-group"><span class="field-label">WhatsApp</span><input type="text" class="paper-input"></div></div>
                    <div class="paper-col"><div class="field-group"><span class="field-label">Email</span><input type="text" class="paper-input"></div></div>
                </div>
            </div>

            <div class="form-section">
                <div class="section-title">KYC & Loan Details</div>
                <div class="paper-row">
                    <div class="paper-col"><div class="field-group"><span class="field-label">Aadhaar Card No</span><input type="text" class="paper-input"></div></div>
                    <div class="paper-col"><div class="field-group"><span class="field-label">PAN Card No</span><input type="text" class="paper-input"></div></div>
                </div>
                <div class="paper-row">
                    <div class="paper-col"><div class="field-group"><span class="field-label">Loan Amount (₹)</span><input type="text" class="paper-input"></div></div>
                    <div class="paper-col"><div class="field-group"><span class="field-label">Interest Rate (%)</span><input type="text" class="paper-input"></div></div>
                    <div class="paper-col"><div class="field-group"><span class="field-label">Tenure (Months)</span><input type="text" class="paper-input"></div></div>
                </div>
                <div class="paper-row">
                    <div class="paper-col"><div class="field-group"><span class="field-label">Issue Date</span><input type="text" class="paper-input"></div></div>
                    <div class="paper-col-2"><div class="field-group"><span class="field-label">Purpose</span><input type="text" class="paper-input"></div></div>
                </div>
            </div>

            <div class="signature-section" style="display: flex; justify-content: space-between; margin-top: 60px; padding: 0 20px;">
                <div class="signature-box" style="text-align: center; width: 200px;">
                    <div style="height:50px;"></div>
                    <div class="signature-line" style="border-top: 1px solid #000; margin-top: 5px; padding-top: 5px; font-weight: bold; font-size: 12px;">Applicant Signature</div>
                </div>
                <div class="signature-box" style="text-align: center; width: 200px;">
                    <div style="height:50px;"></div>
                    <div class="signature-line" style="border-top: 1px solid #000; margin-top: 5px; padding-top: 5px; font-weight: bold; font-size: 12px;">Guarantor Signature</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden Agreement Template for PDF Generation -->
    <div style="position: absolute; left: -9999px;">
        <div id="blank-agreement-form" class="agreement-container">
            <div class="agreement-watermark">CONFIDENTIAL</div>
            <h1>LOAN AGREEMENT</h1>
            <p style="text-align: right;"><strong>Date:</strong> __________________</p>
            
            <div class="agreement-content">
                <p>This <strong>LOAN AGREEMENT</strong> is made and entered into by and between:</p>
                
                <p><strong>LENDER:</strong> <br>
                <strong><span id="ag-company-name">SANJARANG PRIVATE LIMITED</span></strong>, a company incorporated under the Companies Act, having its registered office at <span id="ag-company-address">123 Business Park, Main Road, City</span><span id="ag-company-contact-section"></span> (hereinafter referred to as the "Lender").</p>
                
                <p><strong>AND</strong></p>

                <p><strong>BORROWER:</strong> <br>
                Name: _______________________________________________________<br>
                S/o, D/o, W/o: ________________________________________________<br>
                Address: _____________________________________________________<br>
                (hereinafter referred to as the "Borrower").</p>

                <h3>1. LOAN AMOUNT AND INTEREST</h3>
                <p>The Lender agrees to lend to the Borrower a sum of <strong>₹______________________</strong> (Rupees ______________________________________________________) (the "Principal Amount"). The Borrower agrees to repay this amount with an interest rate of <strong>______% per annum</strong>.</p>

                <h3>2. REPAYMENT TERMS</h3>
                <p>The Borrower shall repay the Principal Amount together with the accrued interest in <strong>______</strong> monthly installments. The repayment shall commence on <strong>____/____/20____</strong> and end on <strong>____/____/20____</strong>.</p>

                <h3>3. DEFAULT AND PENALTIES</h3>
                <p>In the event of a default in payment of any installment on the due date, the Borrower shall be liable to pay a penalty interest of <strong>2% per month</strong> on the overdue amount. If the default continues for more than 3 months, the Lender reserves the right to recall the entire outstanding loan amount immediately and initiate legal proceedings.</p>

                <h3>4. USE OF FUNDS</h3>
                <p>The Borrower confirms that the loan amount shall be used strictly for the purpose of ______________________________________________________ and not for any illegal or speculative activities.</p>

                <h3>5. GUARANTOR</h3>
                <p>This loan is guaranteed by <strong>______________________________________________________</strong> (Name of Guarantor), who agrees to be jointly and severally liable for the repayment of the loan in case of default by the Borrower.</p>
                
                <h3>6. GOVERNING LAW</h3>
                <p>This Agreement shall be governed by and construed in accordance with the laws of India. Any disputes arising out of this agreement shall be subject to the jurisdiction of the courts in [City/District].</p>

                <h3>7. UNDERTAKING BY BORROWER</h3>
                <p>I, the Borrower, hereby declare that:</p>
                <ul style="list-style-type: disc; margin-left: 20px;">
                    <li>I have received the full loan amount mentioned above.</li>
                    <li>I have understood all the terms and conditions of this loan agreement.</li>
                    <li>I undertake to repay the loan amount along with interest within the stipulated time.</li>
                    <li>I understand that in case of default, the Lender has the right to take legal action against me and my guarantor.</li>
                    <li>All documents and information provided by me for this loan application are true and correct.</li>
                </ul>
            </div>

            <div class="agreement-signature-section">
                <div class="agreement-signature-box">
                    <p><strong>Signature of Borrower</strong></p>
                </div>
                <div class="agreement-signature-box">
                    <p><strong>Thumb Impression</strong></p>
                </div>
                <div class="agreement-signature-box">
                    <p><strong>Signature of Guarantor</strong></p>
                </div>
                <div class="agreement-signature-box">
                    <p><strong>For <span id="ag-company-sign-name">Sanjarang Pvt Ltd</span></strong><br>(Authorized Signatory)</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden NOC Template for PDF Generation -->
    <div style="position: absolute; left: -9999px;">
        <div id="noc-template" class="agreement-container">
            <div class="agreement-watermark">NOC</div>
            <h1>TO WHOM IT MAY CONCERN</h1>
            <p style="text-align: right;"><strong>Date:</strong> __________________</p>

            <div class="agreement-content">
                <p>This is to certify that <strong><span id="noc-borrower-name">______________________________________________________</span></strong>,
                resident of <strong>________________________________________________________________________</strong>,
                had availed a loan (Loan Ref: <strong>__________________</strong>) from <strong><span id="noc-company-name">SANJARANG PRIVATE LIMITED</span></strong>.</p>

                <p>We hereby confirm that the said borrower has repaid the entire loan amount along with the accrued interest and other charges. There are no outstanding dues against the said loan account as of date.</p>

                <p>This institution has <strong>NO OBJECTION</strong> to the borrower closing this account or availing financial facilities from other institutions.</p>
            </div>

            <div class="agreement-signature-section">
                <div class="agreement-signature-box" style="border:none;"></div> <!-- Spacer -->
                <div class="agreement-signature-box" style="width: 40%;">
                    <p><strong>For <span id="noc-company-sign-name">Sanjarang Pvt Ltd</span></strong><br>(Authorized Signatory)</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Upload Custom Form Modal -->
    <div id="upload-form-modal" class="custom-modal">
        <div class="custom-modal-content" style="max-width: 500px;">
            <span class="custom-close-modal" id="close-upload-modal">&times;</span>
            <h2>Upload Custom Form</h2>
            <form id="uploadForm">
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">Form Name</label>
                    <input type="text" id="custom-form-name" placeholder="e.g. KYC Update Form" required style="width: 100%;">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">Description</label>
                    <input type="text" id="custom-form-desc" placeholder="Short description..." required style="width: 100%;">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display:block; margin-bottom:5px; font-weight:bold;">Select PDF</label>
                    <input type="file" id="custom-form-file" accept="application/pdf" required style="width: 100%;">
                </div>
                <button type="submit" style="width: 100%; margin-top: 10px;">Upload</button>
            </form>
        </div>
    </div>

    <script src="app.js" defer></script>
</body>
</html>